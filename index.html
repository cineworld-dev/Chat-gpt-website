<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatGPT - AI Assistant</title>
    <link rel="icon" type="image/jpeg" href="https://i.ibb.co/YBtjfZ57/image.jpg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            object-fit: cover;
        }

        .header h1 {
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .chat-container {
            flex: 1;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .welcome-message {
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin-bottom: 2rem;
        }

        .welcome-message h2 {
            color: #333;
            margin-bottom: 1rem;
            font-size: 2rem;
        }

        .welcome-message p {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .message {
            padding: 1rem 1.5rem;
            border-radius: 16px;
            max-width: 80%;
            word-wrap: break-word;
            animation: slideIn 0.3s ease-out;
            line-height: 1.6;
        }

        .user-message {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            align-self: flex-end;
            margin-left: auto;
        }

        .ai-message {
            background: rgba(0, 0, 0, 0.1);
            color: white;
            align-self: flex-start;
            backdrop-filter: blur(10px);
        }

        .code-block {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            margin: 1rem 0;
            overflow: hidden;
            position: relative;
        }

        .code-header {
            background: rgba(0, 0, 0, 0.9);
            padding: 0.5rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .code-language {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            font-weight: 500;
        }

        .copy-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .copy-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .copy-button.copied {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.4);
            color: #22c55e;
        }

        .code-content {
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            color: #f8f8f2;
            white-space: pre-wrap;
        }

        .inline-code {
            background: rgba(0, 0, 0, 0.6);
            color: #f8f8f2;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .input-container {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chat-input {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            background: white;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.5);
        }

        .send-button {
            padding: 1rem 2rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
        }

        .send-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: flex;
            gap: 4px;
            padding: 1rem;
        }

        .loading-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.7);
            animation: bounce 1.4s ease-in-out infinite both;
        }

        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }

        .footer {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            padding: 2rem;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .footer-link {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .footer-link:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            transform: translateY(-2px);
        }

        .footer-credit {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-top: 1rem;
        }

        .footer-credit a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            font-weight: 500;
        }

        .footer-credit a:hover {
            color: white;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }
            
            .chat-container {
                padding: 1rem;
            }
            
            .welcome-message {
                padding: 1.5rem;
            }
            
            .welcome-message h2 {
                font-size: 1.5rem;
            }
            
            .footer-links {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }
            
            .message {
                max-width: 95%;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <img src="https://i.ibb.co/YBtjfZ57/image.jpg" alt="ChatGPT Logo" class="logo">
        <h1>ChatGPT</h1>
    </header>

    <div class="chat-container">
        <div class="welcome-message" id="welcomeMessage">
            <h2>Welcome to ChatGPT</h2>
            <p>I'm here to help you with questions, creative writing, analysis, math, coding, and much more. How can I assist you today?</p>
            <div style="margin-top: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: 8px; font-size: 0.9rem; color: #666;">
                <strong>💡 Try asking:</strong> "Show me some code", "Python example", "HTML structure", or just say "Hi"
            </div>
        </div>

        <div class="chat-messages" id="chatMessages"></div>

        <div class="input-container">
            <input 
                type="text" 
                class="chat-input" 
                id="chatInput" 
                placeholder="Send a message..."
                maxlength="500"
            >
            <button class="send-button" id="sendButton">Send</button>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-links">
            <a href="https://t.me/BJ_Devs" class="footer-link" target="_blank">📱 Join Telegram</a>
            <a href="https://chat.whatsapp.com/DzEAQVOUQndH8Go17QqYLG" class="footer-link" target="_blank">💬 WhatsApp Group</a>
            <a href="https://t.me/BJ_Coder" class="footer-link" target="_blank">👨‍💻 Contact Dev</a>
        </div>
        <div class="footer-credit">
            Created by <a href="https://t.me/zerocreations" target="_blank">Zero Creations</a>
        </div>
    </footer>

    <script>
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        const chatMessages = document.getElementById('chatMessages');
        const welcomeMessage = document.getElementById('welcomeMessage');

        let isLoading = false;

        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'ai-message'}`;
            
            if (isUser) {
                messageDiv.textContent = content;
            } else {
                messageDiv.innerHTML = formatMessage(content);
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return messageDiv;
        }

        function formatMessage(content) {
            // Handle code blocks with language specification
            content = content.replace(/```(\w+)?\n?([\s\S]*?)```/g, (match, language, code) => {
                const lang = language || 'text';
                const codeId = 'code_' + Math.random().toString(36).substr(2, 9);
                return `
                    <div class="code-block">
                        <div class="code-header">
                            <span class="code-language">${lang}</span>
                            <button class="copy-button" onclick="copyCode('${codeId}')">Copy</button>
                        </div>
                        <div class="code-content" id="${codeId}">${escapeHtml(code.trim())}</div>
                    </div>
                `;
            });

            // Handle inline code
            content = content.replace(/`([^`]+)`/g, '<span class="inline-code">$1</span>');

            // Handle line breaks
            content = content.replace(/\n/g, '<br>');

            return content;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyCode(codeId) {
            const codeElement = document.getElementById(codeId);
            const copyButton = codeElement.parentElement.querySelector('.copy-button');
            
            if (codeElement) {
                navigator.clipboard.writeText(codeElement.textContent).then(() => {
                    copyButton.textContent = 'Copied!';
                    copyButton.classList.add('copied');
                    
                    setTimeout(() => {
                        copyButton.textContent = 'Copy';
                        copyButton.classList.remove('copied');
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                    copyButton.textContent = 'Failed';
                    setTimeout(() => {
                        copyButton.textContent = 'Copy';
                    }, 2000);
                });
            }
        }

        function addLoadingMessage() {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ai-message';
            messageDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                    <div class="loading-dot"></div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return messageDiv;
        }

        // Demo responses for when API is unavailable
        const demoResponses = {
            "hi": "Hello! I'm ChatGPT, your AI assistant. How can I help you today?",
            "hello": "Hi there! What would you like to chat about?",
            "code": "Here's a simple JavaScript example:\n\n```javascript\nfunction greetUser(name) {\n    return `Hello, ${name}! Welcome to our chat.`;\n}\n\n// Usage example\nconsole.log(greetUser('User'));\n```\n\nThis function takes a name parameter and returns a personalized greeting message.",
            "python": "Here's a Python example:\n\n```python\ndef calculate_fibonacci(n):\n    if n <= 1:\n        return n\n    else:\n        return calculate_fibonacci(n-1) + calculate_fibonacci(n-2)\n\n# Example usage\nfor i in range(10):\n    print(f'F({i}) = {calculate_fibonacci(i)}')\n```\n\nThis code calculates Fibonacci numbers recursively.",
            "html": "Here's a basic HTML structure:\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>My Website</title>\n</head>\n<body>\n    <h1>Welcome to My Website</h1>\n    <p>This is a paragraph of text.</p>\n</body>\n</html>\n```\n\nThis is a basic HTML5 document structure.",
            "css": "Here's some CSS styling:\n\n```css\n.container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 20px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n}\n\n.button {\n    background: #4CAF50;\n    color: white;\n    padding: 10px 20px;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n}\n\n.button:hover {\n    background: #45a049;\n    transform: translateY(-2px);\n}\n```\n\nThis CSS creates a responsive container and styled button with hover effects."
        };

        function getDemoResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Check for exact matches first
            if (demoResponses[lowerMessage]) {
                return demoResponses[lowerMessage];
            }
            
            // Check for partial matches
            for (const [key, response] of Object.entries(demoResponses)) {
                if (lowerMessage.includes(key)) {
                    return response;
                }
            }
            
            // Default responses
            const defaultResponses = [
                "I'm currently running in demo mode. The main API service might be temporarily unavailable, but I can still help with basic questions and show you code examples!",
                "Thanks for your message! I'm in demo mode right now. Try asking about 'code', 'python', 'html', or 'css' to see some examples.",
                "Hello! I'm here to help. While the main service is offline, I can demonstrate code formatting and basic responses. What would you like to know about?"
            ];
            
            return defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
        }

        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message || isLoading) return;

            // Hide welcome message on first interaction
            if (welcomeMessage.style.display !== 'none') {
                welcomeMessage.style.display = 'none';
            }

            // Add user message
            addMessage(message, true);
            chatInput.value = '';
            
            // Set loading state
            isLoading = true;
            sendButton.disabled = true;
            sendButton.textContent = 'Sending...';
            
            // Add loading animation
            const loadingMessage = addLoadingMessage();

            try {
                // Try the API first with a timeout
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout
                
                const response = await fetch(`https://gpt-3-5.apis-bj-devs.workers.dev/?prompt=${encodeURIComponent(message)}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json',
                    },
                    signal: controller.signal,
                });
                
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Remove loading message
                if (chatMessages.contains(loadingMessage)) {
                    chatMessages.removeChild(loadingMessage);
                }
                
                if (data.status && data.reply) {
                    addMessage(data.reply);
                } else {
                    // Fallback to demo mode if API returns invalid data
                    addMessage(getDemoResponse(message));
                }
                
            } catch (error) {
                // Remove loading message
                if (chatMessages.contains(loadingMessage)) {
                    chatMessages.removeChild(loadingMessage);
                }
                
                console.log('API unavailable, switching to demo mode:', error.message);
                
                // Use demo response instead of showing error
                addMessage(getDemoResponse(message));
                
            } finally {
                // Reset loading state
                isLoading = false;
                sendButton.disabled = false;
                sendButton.textContent = 'Send';
                chatInput.focus();
            }
        }

        // Event listeners
        sendButton.addEventListener('click', sendMessage);
        
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Focus input on load
        chatInput.focus();
    </script>
</body>
</html>
